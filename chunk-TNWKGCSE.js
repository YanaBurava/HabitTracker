import{q}from"./chunk-BFZJCCXN.js";import{a as C,b as p,e as L,f as R,g as z,h as $}from"./chunk-WCOTOCZP.js";import{Aa as O,Fa as b,Ia as T,Ja as h,Jb as j,Ka as y,Kb as A,La as Y,Oa as N,Ob as B,Sa as i,Ta as a,Ua as M,Va as V,W as E,X as f,Xa as _,Y as x,Ya as l,Z as F,Zb as G,gb as o,hb as P,ib as m,ra as c,rb as v,tb as D,va as I}from"./chunk-2MNLC77U.js";function S(r,t,e){let n=p(r,e?.in);if(isNaN(t))return C(e?.in||r,NaN);if(!t)return n;let s=n.getDate(),g=C(e?.in||r,n.getTime());g.setMonth(n.getMonth()+t+1,0);let d=g.getDate();return s>=d?g:(n.setFullYear(g.getFullYear(),g.getMonth(),s),n)}function J(r,t){let e=p(r,t?.in),n=e.getMonth();return e.setFullYear(e.getFullYear(),n+1,0),e.setHours(23,59,59,999),e}function K(r,t){let[e,n]=L(r,t.start,t.end);return{start:e,end:n}}function H(r,t){let{start:e,end:n}=K(t?.in,r),s=+e>+n,g=s?+e:+n,d=s?n:e;d.setHours(0,0,0,0);let u=t?.step??1;if(!u)return[];u<0&&(u=-u,s=!s);let k=[];for(;+d<=g;)k.push(C(e,d)),d.setDate(d.getDate()+u),d.setHours(0,0,0,0);return s?k.reverse():k}function Q(r,t){let e=p(r,t?.in);return e.setDate(1),e.setHours(0,0,0,0),e}function U(r,t){let e=p(r,t?.in),n=e.getFullYear();return e.setFullYear(n+1,0,0),e.setHours(23,59,59,999),e}var w=class r{progress=0;radius=50;circumference=2*Math.PI*this.radius;strokeDashoffset=this.circumference;ngOnChanges(){let t=Math.min(100,Math.max(0,this.progress));this.strokeDashoffset=this.circumference-this.circumference*t/100}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=O({type:r,selectors:[["app-circular-progress"]],inputs:{progress:"progress"},standalone:!1,features:[E],decls:10,vars:3,consts:[[1,"progress-circle"],["viewBox","0 0 120 120","width","100%","height","100%","preserveAspectRatio","xMidYMid meet"],["cx","60","cy","60","r","50","stroke","#e6e6e6","stroke-width","10","fill","none"],["cx","60","cy","60","r","50","stroke","url(#grad)","stroke-width","10","fill","none","stroke-linecap","round","transform","rotate(-90 60 60)"],["id","grad","x1","1","y1","0","x2","0","y2","1"],["offset","0%","stop-color","#00c9ff"],["offset","100%","stop-color","#92fe9d"],["x","50%","y","50%","text-anchor","middle","dominant-baseline","central","font-size","24","fill","#00c9ff","font-weight","bold"]],template:function(e,n){e&1&&(i(0,"div",0),F(),i(1,"svg",1),M(2,"circle",2)(3,"circle",3),i(4,"defs")(5,"linearGradient",4),M(6,"stop",5)(7,"stop",6),a()(),i(8,"text",7),o(9),a()()()),e&2&&(c(3),T("stroke-dasharray",n.circumference)("stroke-dashoffset",n.strokeDashoffset),c(6),m(" ",n.progress,"% "))},styles:[".progress-circle[_ngcontent-%COMP%]{width:100%;max-width:250px;aspect-ratio:1/1;flex-shrink:0;background:#fff;border-radius:20px;box-shadow:0 8px 20px #0000001a;padding:20px;display:flex;align-items:center;justify-content:center;filter:drop-shadow(0 4px 8px rgba(0,0,0,.15));transition:box-shadow .3s ease}.progress-circle[_ngcontent-%COMP%]:hover{box-shadow:0 12px 30px #0003}.progress-circle[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.progress-circle[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{transition:stroke-dashoffset .5s ease}.progress-circle[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]:nth-child(2){filter:drop-shadow(0 0 8px rgba(0,140,255,.5))}"]})};function te(r,t){if(r&1&&M(0,"app-circular-progress",12),r&2){let e=l(2);h("progress",e.getProgress(e.habit))}}function ne(r,t){if(r&1&&(i(0,"div",13),v(1,"date"),o(2),v(3,"date"),a()),r&2){let e=t.$implicit,n=l(2);y("background-color",n.isMarked(e)?n.habit==null?null:n.habit.color:"#ccc"),Y("marked",n.isMarked(e))("empty",!n.isMarked(e)),h("matTooltip",D(1,8,e,"fullDate")),c(2),m(" ",D(3,11,e,"d")," ")}}function re(r,t){if(r&1&&(i(0,"div",14),v(1,"date"),o(2," \xA0 "),a()),r&2){let e=t.$implicit,n=l(2);y("background-color",n.isMarked(e)?n.habit==null?null:n.habit.color:"#ccc"),Y("marked",n.isMarked(e)),h("title",D(1,5,e,"dd MMM yyyy"))}}function ie(r,t){if(r&1){let e=V();i(0,"h2",1),o(1),a(),i(2,"p")(3,"strong"),o(4,"Group:"),a(),o(5),a(),i(6,"p")(7,"strong"),o(8,"Goal:"),a(),o(9),a(),i(10,"div",2),b(11,te,1,1,"app-circular-progress",3),i(12,"div",4)(13,"div",5)(14,"button",6),_("click",function(){f(e);let s=l();return x(s.previousMonth())}),o(15,"\u2190"),a(),i(16,"h2"),o(17),a(),i(18,"button",6),_("click",function(){f(e);let s=l();return x(s.nextMonth())}),o(19,"\u2192"),a()(),i(20,"div",7),b(21,ne,4,14,"div",8),a()()(),i(22,"section")(23,"div",9)(24,"button",6),_("click",function(){f(e);let s=l();return x(s.previousYear())}),o(25,"\u2190"),a(),i(26,"h2"),o(27),a(),i(28,"button",6),_("click",function(){f(e);let s=l();return x(s.nextYear())}),o(29,"\u2192"),a()(),i(30,"div",10),b(31,re,3,8,"div",11),a()()}if(r&2){let e=l();y("--habit-color",e.habit==null?null:e.habit.color),c(),P(e.habit==null?null:e.habit.name),c(4),m(" ",e.habit==null?null:e.habit.group,""),c(4),m(" ",e.habit==null?null:e.habit.goal,""),c(2),h("ngIf",e.habit),c(6),P(e.getMonthLabel()),c(4),h("ngForOf",e.daysInMonth),c(6),P(e.getYearLabel()),c(4),h("ngForOf",e.daysInYear)}}function ae(r,t){r&1&&(i(0,"p"),o(1,"Habit not found."),a())}var W=class r{constructor(t,e){this.route=t;this.habitService=e}habit=null;currentMonth=new Date;currentYear=new Date().getFullYear();daysInMonth=[];daysInYear=[];ngOnInit(){let t=Number(this.route.snapshot.paramMap.get("id"));t&&(this.habit=this.habitService.getHabitById(t)),this.generateMonthDays(),this.generateYearDays()}generateMonthDays(){let t=Q(this.currentMonth),e=J(this.currentMonth);this.daysInMonth=H({start:t,end:e})}generateYearDays(){let t=R(new Date(this.currentYear,0,1)),e=U(new Date(this.currentYear,0,1));this.daysInYear=H({start:t,end:e})}previousMonth(){this.currentMonth=S(this.currentMonth,-1),this.generateMonthDays(),this.generateYearDays()}nextMonth(){this.currentMonth=S(this.currentMonth,1),this.generateMonthDays(),this.generateYearDays()}isMarked(t){if(!this.habit)return!1;let e=this.habitService.formatDate(t);return this.habitService.isMarkedDay(this.habit,e)}getMonthLabel(){return z(this.currentMonth,"MMMM yyyy")}getYearLabel(){return z(this.currentMonth,"yyyy")}getProgress(t){if(!t.progress||t.progress.length===0)return 0;let e=t.progress.length;return Math.min(100,Math.round(e/t.goal*100))}previousYear(){this.currentYear-=1,this.currentMonth=new Date(this.currentYear,this.currentMonth.getMonth(),1),this.generateYearDays(),this.generateMonthDays()}nextYear(){this.currentYear+=1,this.currentMonth=new Date(this.currentYear,this.currentMonth.getMonth(),1),this.generateYearDays(),this.generateMonthDays()}static \u0275fac=function(e){return new(e||r)(I(G),I($))};static \u0275cmp=O({type:r,selectors:[["app-habit-detail"]],standalone:!1,decls:3,vars:1,consts:[[1,"habit-details"],[1,"habit-name"],[1,"progress-and-calendar"],[3,"progress",4,"ngIf"],[1,"resizable-calendar-container"],[1,"calendar-header"],[3,"click"],[1,"calendar-grid"],[3,"marked","empty","matTooltip","backgroundColor",4,"ngFor","ngForOf"],[1,"year-navigation"],[1,"year-heatmap"],["class","day-cell",3,"marked","backgroundColor","title",4,"ngFor","ngForOf"],[3,"progress"],[3,"matTooltip"],[1,"day-cell",3,"title"]],template:function(e,n){e&1&&(i(0,"div",0),b(1,ie,32,10)(2,ae,2,0,"p"),a()),e&2&&(c(),N(n.habit!=null&&n.habit.name?1:2))},dependencies:[j,A,q,w,B],styles:[".habit-details[_ngcontent-%COMP%]{padding:20px;max-width:800px;margin:0 auto 40px;font-family:Arial,sans-serif}.habit-details[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{border-radius:6px;color:#a8a3a3;display:inline-block}.habit-details[_ngcontent-%COMP%]   .habit-name[_ngcontent-%COMP%]{text-align:center;text-shadow:2px 2px 4px var(--habit-color, #6c6e6c)}.habit-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin:8px 0;color:#12142eab}.habit-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#6e6868;font-weight:600;margin-right:6px}.habit-details[_ngcontent-%COMP%]   section[_ngcontent-%COMP%]{margin-top:40px}.progress-and-calendar[_ngcontent-%COMP%]{display:flex;gap:20px}.progress-and-calendar[_ngcontent-%COMP%]   .progress-circle[_ngcontent-%COMP%]{width:40%}.progress-and-calendar[_ngcontent-%COMP%]   .resizable-calendar-container[_ngcontent-%COMP%]{width:60%}.progress-circle[_ngcontent-%COMP%]{flex:1 1 0;width:100%;height:auto;aspect-ratio:1/1;max-width:600px;max-height:600px}.resizable-calendar-container[_ngcontent-%COMP%]{resize:both;overflow:auto;min-width:320px;min-height:360px;max-width:100%;max-height:100%;border:1px solid #ddd;padding:20px 12px 12px;box-sizing:border-box;background-color:#fff;border-radius:12px;box-shadow:0 0 10px #0000000d;flex-grow:1}.resizable-calendar-container[_ngcontent-%COMP%]   .calendar-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;width:100%;padding:0 10px}.resizable-calendar-container[_ngcontent-%COMP%]   .calendar-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;font-size:1.8rem;cursor:pointer;color:#333;padding:0;line-height:1;-webkit-user-select:none;user-select:none;transition:color .3s ease}.resizable-calendar-container[_ngcontent-%COMP%]   .calendar-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#1b183b94}.resizable-calendar-container[_ngcontent-%COMP%]   .calendar-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem}.resizable-calendar-container[_ngcontent-%COMP%]   .calendar-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);gap:8px;width:100%;max-height:100%;box-sizing:border-box}.resizable-calendar-container[_ngcontent-%COMP%]   .calendar-grid[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%;aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;border-radius:8px;font-size:18px;color:#fff;cursor:pointer;-webkit-user-select:none;user-select:none;box-shadow:0 2px 5px #00000040;transition:background-color .3s ease;padding:6px}.marked[_ngcontent-%COMP%]{background-color:var(--habit-color, #4caf50)}.empty[_ngcontent-%COMP%]{background-color:#ccc;color:#666}.year-navigation[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:5px}.year-navigation[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;font-size:1.8rem;cursor:pointer;color:#333;padding:0;line-height:1;-webkit-user-select:none;user-select:none;transition:color .3s ease}.year-navigation[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{color:#1b183b94}.year-navigation[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem}.year-heatmap[_ngcontent-%COMP%]{margin-top:10px;display:grid;grid-template-columns:repeat(53,12px);grid-auto-rows:12px;gap:4px;justify-content:start}.year-heatmap[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:12px;height:12px;background-color:#eee;border-radius:3px;cursor:default;box-shadow:0 0 2px #0000001a;transition:background-color .3s ease}.year-heatmap[_ngcontent-%COMP%]   div.marked[_ngcontent-%COMP%]{background-color:var(--habit-color, #4caf50)}@media (max-width: 480px){.habit-details[_ngcontent-%COMP%]{padding:10px}.habit-details[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:12px}.habit-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;margin:6px 0}.progress-and-calendar[_ngcontent-%COMP%]{flex-direction:column;gap:16px;align-items:center}.progress-circle[_ngcontent-%COMP%]{width:150px;height:150px}.resizable-calendar-container[_ngcontent-%COMP%]{min-width:100%;min-height:auto;padding:20px 12px 12px}.resizable-calendar-container[_ngcontent-%COMP%]   .calendar-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:1.4rem}.resizable-calendar-container[_ngcontent-%COMP%]   .calendar-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.2rem}.resizable-calendar-container[_ngcontent-%COMP%]   .calendar-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(7,1fr);gap:4px}.resizable-calendar-container[_ngcontent-%COMP%]   .calendar-grid[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-size:14px;padding:2px}.year-heatmap[_ngcontent-%COMP%]{grid-template-columns:repeat(26,12px);gap:2px}.year-heatmap[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:10px;height:10px}}"]})};export{W as a};
