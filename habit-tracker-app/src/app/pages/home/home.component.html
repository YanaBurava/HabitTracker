<div class="header-weather">
  <h1 class="main-title">My Habits Tracker</h1>

  <div class="content-block">
    <mat-calendar [selected]="today" disabled="true"></mat-calendar>
    <app-weather></app-weather>
  </div>
</div>

<div class="week-navigation mat-elevation-z2">
  <button mat-icon-button (click)="previousWeek()">
    <mat-icon>chevron_left</mat-icon>
  </button>
  <span>{{ currentWeekStart | date: 'MMM d' }} â€“ {{ currentWeekEnd | date: 'MMM d' }}</span>
  <button mat-icon-button (click)="nextWeek()">
    <mat-icon>chevron_right</mat-icon>
  </button>
</div>

<div class="habit-table">
  <table>
    <thead>
      <tr>
        <th>Habit</th>
        <th *ngFor="let date of weekDates">{{ date | date: 'EEE d' }}</th>
        <th>Progress</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let habit of habits">
        <td (click)="goToHabitDetail(habit)">{{ habit.name }}</td>
        <td
          *ngFor="let date of weekDates"
          [ngStyle]="{
            backgroundColor: isMarked(habit, date) ? habit.color + '33' : 'rgba(255, 255, 255, 0.4)',
            boxShadow: isMarked(habit, date)
              ? '0 4px 8px rgba(0, 0, 0, 0.25), inset 0 2px 4px rgba(255, 255, 255, 0.4)'
              : '0 2px 4px rgba(0, 0, 0, 0.15), inset 0 2px 4px rgba(255, 255, 255, 0.3)'
          }"
          (click)="toggleMark(habit, date)"
          class="clickable"
        >
          <input
            type="checkbox"
            [checked]="isMarked(habit, date)"
            (click)="$event.stopPropagation(); toggleMark(habit, date)"
          />
        </td>
        <td>
          <div class="progress-container">
            <div class="progress-bar" [style.width.%]="getProgress(habit)"></div>
            <span>{{ getProgress(habit) }}%</span>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
