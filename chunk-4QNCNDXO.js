import{a as N}from"./chunk-IVMDRUOV.js";import{d as j,h as V}from"./chunk-3OJHVJHJ.js";import{s as $,t as z}from"./chunk-6ZZP2B64.js";import"./chunk-UPGNFGOG.js";import{$b as R,Aa as T,Ba as u,Fa as m,Ib as P,Ja as p,Jb as D,Ka as f,Kb as H,La as S,P as b,Rb as F,Sa as s,Ta as c,Va as O,X as h,Xa as y,Y as x,Ya as l,Yb as E,cc as g,gb as d,hb as _,ib as v,pb as w,ra as n,v as I,va as M}from"./chunk-2MNLC77U.js";var Y=o=>({marked:o});function q(o,e){o&1&&(s(0,"mat-icon"),d(1,"check"),c())}function B(o,e){o&1&&(s(0,"mat-icon",12),d(1,"emoji_events"),c())}function J(o,e){if(o&1){let t=O();s(0,"div",13),y("click",function(){let a=h(t).index,r=l().$implicit,G=l();return x(G.toggleMark(r,a))}),d(1),c()}if(o&2){let t=e.$implicit,i=e.index,a=l().$implicit,r=l();f("background-color",r.isMarked(a,i)?a.color:"transparent")("color",r.isMarked(a,i)?"#fff":"#999"),S("marked",r.isMarked(a,i)),n(),v(" ",t,`
`)}}function K(o,e){if(o&1){let t=O();s(0,"div",1)(1,"div",2)(2,"button",3),y("click",function(){let a=h(t).$implicit,r=l();return x(r.toggleMarkToday(a))}),m(3,q,2,0,"mat-icon",4),c(),s(4,"mat-icon",5),d(5),c(),s(6,"span",6),y("click",function(){let a=h(t).$implicit,r=l();return x(r.goToHabitDetail(a))}),d(7),c(),s(8,"div",7),d(9),m(10,B,2,0,"mat-icon",8),c()(),s(11,"p",9),d(12),c(),s(13,"div",10),m(14,J,2,7,"div",11),c()()}if(o&2){let t=e.$implicit,i=l();f("border-color",t.color),n(2),f("background-color",i.isMarkedToday(t)?t.color:"#ccc"),p("ngClass",w(16,Y,i.isMarkedToday(t))),n(),p("ngIf",i.isMarkedToday(t)),n(),f("color",i.isMarkedToday(t)?t.color:"#ccc"),n(),v("",t.icon," "),n(2),_(t.name),n(),S("goal-reached",i.hasReachedGoal(t)),n(),v(" ",i.getProgressText(t)," "),n(),p("ngIf",i.hasReachedGoal(t)),n(2),_(t.description),n(2),p("ngForOf",i.daysOfWeek)}}var k=class o{constructor(e,t){this.habitService=e;this.router=t}habits=[];daysOfWeek=["Mo","Tu","We","Th","Fr","Sa","Su"];daysISO=[];todayDateStr="";currentDayIndex=0;ngOnInit(){this.todayDateStr=this.habitService.formatDate(new Date),this.router.events.pipe(I(e=>e instanceof E)).subscribe(()=>{this.refreshHabits()}),this.habits=this.habitService.getActiveHabits(),this.updateDaysISO(),this.currentDayIndex=this.getCurrentDayIndex()}updateDaysISO(){let t=j(new Date,{weekStartsOn:1});this.daysISO=Array.from({length:7},(i,a)=>{let r=N(t,a);return this.habitService.formatDate(r)})}isMarked(e,t){let i=this.daysISO[t];return this.habitService.isMarkedDay(e,i)}toggleMark(e,t){let i=this.daysISO[t];this.habitService.toggleMarkDay(e,i),this.refreshHabits()}toggleMarkToday(e){this.habitService.toggleMarkDay(e,this.todayDateStr),this.refreshHabits()}isMarkedToday(e){return this.habitService.isMarkedDay(e,this.todayDateStr)}getProgressText(e){return`${e.progress.length}/${e.goal}`}hasReachedGoal(e){return e.progress.length>=e.goal}getCurrentDayIndex(){let e=this.todayDateStr;return this.daysISO.findIndex(t=>t===e)}goToHabitDetail(e){this.router.navigate(["/habit",e.id])}refreshHabits(){this.habits=this.habitService.getActiveHabits()}static \u0275fac=function(t){return new(t||o)(M(V),M(R))};static \u0275cmp=T({type:o,selectors:[["app-today"]],standalone:!1,decls:3,vars:2,consts:[["class","habit-card",3,"borderColor",4,"ngFor","ngForOf"],[1,"habit-card"],[1,"habit-info"],[1,"mark-today-btn",3,"click","ngClass"],[4,"ngIf"],[1,"habit-icon"],[1,"habit-name",3,"click"],[1,"habit-progress"],["class","goal-icon",4,"ngIf"],[1,"habit-description"],[1,"days-row"],["class","day-box",3,"marked","backgroundColor","color","click",4,"ngFor","ngForOf"],[1,"goal-icon"],[1,"day-box",3,"click"]],template:function(t,i){t&1&&(s(0,"h2"),d(1),c(),m(2,K,15,18,"div",0)),t&2&&(n(),_(i.todayDateStr),n(),p("ngForOf",i.habits))},dependencies:[P,D,H,$],styles:[".habit-card[_ngcontent-%COMP%]{border-radius:16px;padding:16px 24px;margin-bottom:12px;font-family:Arial,sans-serif;display:flex;flex-direction:column;background:linear-gradient(145deg,#35353d80,#33333f48);-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px);box-shadow:0 8px 24px #00000059;border:1px solid rgba(255,255,255,.1);transition:box-shadow .3s ease,transform .2s ease;transform:scale(.98)}.habit-card[_ngcontent-%COMP%]:hover{box-shadow:0 12px 28px #00000073;transform:translateY(-2px)}.habit-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:10px}.habit-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:8px}.mark-today-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;border:none;cursor:pointer;display:flex;justify-content:center;align-items:center;font-size:22px;padding:0;margin-right:8px;background:linear-gradient(135deg,#6e8efb,#a777e3);color:#fff;box-shadow:0 0 12px #9000ff99;transition:all .3s ease}.mark-today-btn.marked[_ngcontent-%COMP%]{background:linear-gradient(135deg,#00c9ff,#92fe9d);box-shadow:0 0 16px #00ffa3b3}.mark-today-btn[_ngcontent-%COMP%]:hover{filter:brightness(1.1);transform:scale(1.05)}.mark-today-btn[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #00ffff80}.habit-icon[_ngcontent-%COMP%]{font-size:28px;color:#ddd}.habit-name[_ngcontent-%COMP%]{font-weight:600;font-size:18px;flex-grow:1;color:#fff;cursor:pointer}.habit-description[_ngcontent-%COMP%]{font-size:14px;color:#eff0ee;margin-bottom:12px}.days-row[_ngcontent-%COMP%]{display:flex;gap:10px}.day-box[_ngcontent-%COMP%]{width:28px;height:28px;line-height:28px;text-align:center;border-radius:6px;cursor:pointer;-webkit-user-select:none;user-select:none;font-weight:600;font-size:14px;background-color:#f7f5f5;color:#eee9e9;transition:all .3s ease}.day-box.marked[_ngcontent-%COMP%]{background:linear-gradient(135deg,#00c9ff,#92fe9d);color:#fff;box-shadow:0 0 6px #00ffc899}.day-box[_ngcontent-%COMP%]:hover{background-color:#e0dadac9}.habit-progress[_ngcontent-%COMP%]{font-size:13px;color:#fff;display:flex;align-items:center}.habit-progress.goal-reached[_ngcontent-%COMP%]{color:#ffe600ad;font-weight:700}.habit-progress.goal-reached[_ngcontent-%COMP%]   .goal-icon[_ngcontent-%COMP%]{margin-left:4px;color:#ffe600}"]})};var L=[{path:"",component:k}],C=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=u({type:o});static \u0275inj=b({imports:[g.forChild(L),g]})};var W=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=u({type:o});static \u0275inj=b({imports:[F,C,z,g]})};export{W as TodayModule};
